# Surgery Simulation Sharing - System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SURGERY SIMULATION SHARING                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND (Next.js)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  /surgery-simulation Page                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚        â”‚
â”‚  â”‚  â”‚ Create Session   â”‚    â”‚  Join Session    â”‚             â”‚        â”‚
â”‚  â”‚  â”‚  â€¢ Name          â”‚    â”‚  â€¢ Enter Code    â”‚             â”‚        â”‚
â”‚  â”‚  â”‚  â€¢ Scenario      â”‚    â”‚  â€¢ Browse List   â”‚             â”‚        â”‚
â”‚  â”‚  â”‚  â€¢ Max Users     â”‚    â”‚  â€¢ Click Link    â”‚             â”‚        â”‚
â”‚  â”‚  â”‚  â€¢ Invite Only   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚        â”‚
â”‚  â”‚                                                             â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚        â”‚
â”‚  â”‚  â”‚      Share Dialog (After Creation)          â”‚          â”‚        â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚          â”‚        â”‚
â”‚  â”‚  â”‚  â”‚  Link: http://...?link=abc123...   â”‚ ğŸ“‹ â”‚          â”‚        â”‚
â”‚  â”‚  â”‚  â”‚  Code: ABCD1234                    â”‚ ğŸ“‹ â”‚          â”‚        â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚          â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â”‚  3D Simulation Component                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  â€¢ Surgical Scene (Three.js)                               â”‚        â”‚
â”‚  â”‚  â€¢ Tool Cursors (Local + Remote)                           â”‚        â”‚
â”‚  â”‚  â€¢ Collaborative Cursors                                   â”‚        â”‚
â”‚  â”‚  â€¢ Real-time Tissue Deformation                            â”‚        â”‚
â”‚  â”‚  â€¢ Participant List                                        â”‚        â”‚
â”‚  â”‚  â€¢ Voice/Text Chat                                         â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                                   â”‚
                       â”‚ REST API                          â”‚ Socket.IO
                       â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND (Node.js/Express)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  REST API Endpoints                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  POST   /api/simulations/sessions                          â”‚        â”‚
â”‚  â”‚         â†’ Create new session + generate link/code          â”‚        â”‚
â”‚  â”‚                                                             â”‚        â”‚
â”‚  â”‚  GET    /api/simulations/sessions/active                   â”‚        â”‚
â”‚  â”‚         â†’ List public active sessions                      â”‚        â”‚
â”‚  â”‚                                                             â”‚        â”‚
â”‚  â”‚  POST   /api/simulations/sessions/join/:identifier         â”‚        â”‚
â”‚  â”‚         â†’ Join session via link or code                    â”‚        â”‚
â”‚  â”‚                                                             â”‚        â”‚
â”‚  â”‚  GET    /api/simulations/sessions/link/:identifier         â”‚        â”‚
â”‚  â”‚         â†’ Get session info before joining                  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â”‚  Socket.IO Events (Real-time)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  surgery:join-session                                      â”‚        â”‚
â”‚  â”‚  surgery:leave-session                                     â”‚        â”‚
â”‚  â”‚  surgery:simulation-control (start/pause/stop)             â”‚        â”‚
â”‚  â”‚  surgery:tool-select                                       â”‚        â”‚
â”‚  â”‚  surgery:tool-interact                                     â”‚        â”‚
â”‚  â”‚  surgery:tissue-interact                                   â”‚        â”‚
â”‚  â”‚  surgery:cursor-update                                     â”‚        â”‚
â”‚  â”‚  surgery:chat-message                                      â”‚        â”‚
â”‚  â”‚  surgery:reset-simulation                                  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â”‚  Session Management                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  surgerySessionUsers Map                                   â”‚        â”‚
â”‚  â”‚  sessionId â†’ Map<userId â†’ { socketId, userName, role }>   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATABASE (MongoDB)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Simulations Collection                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  {                                                         â”‚        â”‚
â”‚  â”‚    _id: ObjectId("..."),                                   â”‚        â”‚
â”‚  â”‚    sessionId: "session_1699441234567_abc",                 â”‚        â”‚
â”‚  â”‚    uniqueLink: "a1b2c3d4e5f6...",      // 32 chars         â”‚        â”‚
â”‚  â”‚    shareableCode: "ABCD1234",          // 8 chars          â”‚        â”‚
â”‚  â”‚    title: "Cardiac Surgery Training",                      â”‚        â”‚
â”‚  â”‚    description: "Advanced procedure",                      â”‚        â”‚
â”‚  â”‚    scenario: "cardiac-surgery",                            â”‚        â”‚
â”‚  â”‚    creatorId: ObjectId("..."),                             â”‚        â”‚
â”‚  â”‚    userId: ObjectId("..."),                                â”‚        â”‚
â”‚  â”‚    maxParticipants: 6,                                     â”‚        â”‚
â”‚  â”‚    participantCount: 3,                                    â”‚        â”‚
â”‚  â”‚    inviteOnly: false,                                      â”‚        â”‚
â”‚  â”‚    status: "active",      // idle/active/paused/completed  â”‚        â”‚
â”‚  â”‚    collaborativeData: {                                    â”‚        â”‚
â”‚  â”‚      participants: [                                       â”‚        â”‚
â”‚  â”‚        {                                                   â”‚        â”‚
â”‚  â”‚          userId: ObjectId("..."),                          â”‚        â”‚
â”‚  â”‚          name: "Dr. Smith",                                â”‚        â”‚
â”‚  â”‚          role: "surgeon",                                  â”‚        â”‚
â”‚  â”‚          joinedAt: Date,                                   â”‚        â”‚
â”‚  â”‚          leftAt: Date                                      â”‚        â”‚
â”‚  â”‚        },                                                  â”‚        â”‚
â”‚  â”‚        ...                                                 â”‚        â”‚
â”‚  â”‚      ],                                                    â”‚        â”‚
â”‚  â”‚      totalMessages: 15,                                    â”‚        â”‚
â”‚  â”‚      voiceTime: 320                                        â”‚        â”‚
â”‚  â”‚    },                                                      â”‚        â”‚
â”‚  â”‚    duration: 1200,        // seconds                       â”‚        â”‚
â”‚  â”‚    score: 85,                                              â”‚        â”‚
â”‚  â”‚    errors: 2,                                              â”‚        â”‚
â”‚  â”‚    tissueInteractions: [...],                             â”‚        â”‚
â”‚  â”‚    cuts: [...],                                            â”‚        â”‚
â”‚  â”‚    toolsUsed: ["scalpel", "forceps"],                     â”‚        â”‚
â”‚  â”‚    performance: { precision: 90, speed: 85, ... },        â”‚        â”‚
â”‚  â”‚    createdAt: Date,                                        â”‚        â”‚
â”‚  â”‚    updatedAt: Date                                         â”‚        â”‚
â”‚  â”‚  }                                                         â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â”‚  Indexes:                                                               â”‚
â”‚  â€¢ sessionId                                                            â”‚
â”‚  â€¢ uniqueLink (unique)                                                  â”‚
â”‚  â€¢ shareableCode (unique, sparse)                                       â”‚
â”‚  â€¢ userId                                                               â”‚
â”‚  â€¢ creatorId                                                            â”‚
â”‚  â€¢ status                                                               â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA FLOW DIAGRAM                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CREATE SESSION FLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  User                Frontend              Backend              MongoDB
   â”‚                     â”‚                     â”‚                     â”‚
   â”‚  Fill Form          â”‚                     â”‚                     â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚                     â”‚
   â”‚                     â”‚  POST /sessions     â”‚                     â”‚
   â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
   â”‚                     â”‚                     â”‚  Generate IDs       â”‚
   â”‚                     â”‚                     â”‚  (uniqueLink,       â”‚
   â”‚                     â”‚                     â”‚   shareableCode)    â”‚
   â”‚                     â”‚                     â”‚                     â”‚
   â”‚                     â”‚                     â”‚  Save Session       â”‚
   â”‚                     â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                     â”‚                     â”‚                     â”‚
   â”‚                     â”‚                     â”‚  Session Saved      â”‚
   â”‚                     â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                     â”‚                     â”‚                     â”‚
   â”‚                     â”‚  Return Session     â”‚                     â”‚
   â”‚                     â”‚  + shareableLink    â”‚                     â”‚
   â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
   â”‚                     â”‚                     â”‚                     â”‚
   â”‚  Show Share Dialog  â”‚                     â”‚                     â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                     â”‚
   â”‚  ğŸ“‹ Copy Link/Code  â”‚                     â”‚                     â”‚
   â”‚                     â”‚                     â”‚                     â”‚


JOIN SESSION FLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  User 1              User 2                Backend              MongoDB
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚  Share Code       â”‚                      â”‚                     â”‚
    â”‚  "ABCD1234"       â”‚                      â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚                     â”‚
    â”‚                   â”‚  Enter Code          â”‚                     â”‚
    â”‚                   â”‚  Click Join          â”‚                     â”‚
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚                   â”‚  POST /join/ABCD1234 â”‚                     â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
    â”‚                   â”‚                      â”‚  Find Session       â”‚
    â”‚                   â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚                      â”‚  Session Found      â”‚
    â”‚                   â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚                   â”‚                      â”‚  Add Participant    â”‚
    â”‚                   â”‚                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚                      â”‚  Updated            â”‚
    â”‚                   â”‚                      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚                   â”‚  Session Data        â”‚                     â”‚
    â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚                   â”‚  Socket.IO Join      â”‚                     â”‚
    â”‚                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
    â”‚  Participant      â”‚                      â”‚  Participant        â”‚
    â”‚  Joined Notify    â”‚                      â”‚  Joined Notify      â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                   â”‚                      â”‚                     â”‚
    â”‚  Both users now see each other          â”‚                     â”‚
    â”‚  in real-time 3D simulation             â”‚                     â”‚
    â”‚                                          â”‚                     â”‚


REAL-TIME INTERACTION FLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  User 1                 Backend               User 2
    â”‚                       â”‚                     â”‚
    â”‚  Select Tool          â”‚                     â”‚
    â”‚  (Scalpel)            â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
    â”‚  surgery:tool-select  â”‚                     â”‚
    â”‚                       â”‚  Broadcast          â”‚
    â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                       â”‚  tool-selected      â”‚
    â”‚                       â”‚                     â”‚
    â”‚  Interact with Tissue â”‚                     â”‚
    â”‚  (Cut motion)         â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
    â”‚  surgery:tissue-      â”‚  Save to DB         â”‚
    â”‚  interact             â”‚  + Broadcast        â”‚
    â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                       â”‚  tissue-update      â”‚
    â”‚                       â”‚                     â”‚
    â”‚                       â”‚  User 2 sees cut    â”‚
    â”‚                       â”‚  on their screen    â”‚
    â”‚                       â”‚                     â”‚
    â”‚  Move Cursor          â”‚                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
    â”‚  surgery:cursor-      â”‚  Broadcast          â”‚
    â”‚  update               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                       â”‚  cursor-position    â”‚
    â”‚                       â”‚                     â”‚
    â”‚                       â”‚  User 2 sees        â”‚
    â”‚                       â”‚  User 1's cursor    â”‚
    â”‚                       â”‚                     â”‚


SHAREABLE IDENTIFIERS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  Session Document in MongoDB:
  
  sessionId:      "session_1699441234567_abc123"
                  â†“ Internal tracking
                  
  uniqueLink:     "a1b2c3d4e5f6789abcdef123456789ab"
                  â†“ Used in URL
                  http://localhost:3000/surgery-simulation?link=a1b2c3...
                  
  shareableCode:  "ABCD1234"
                  â†“ Easy to type/share
                  "Join my surgery sim: ABCD1234"


PARTICIPANT TRACKING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  collaborativeData: {
    participants: [
      {
        userId: "user_123",
        name: "Dr. Smith",
        role: "surgeon",         â† Creator/Host
        joinedAt: "2024-11-08T10:00:00Z",
        leftAt: null             â† Still in session
      },
      {
        userId: "user_456",
        name: "Dr. Jones",
        role: "assistant",       â† Joined via link
        joinedAt: "2024-11-08T10:05:00Z",
        leftAt: null
      },
      {
        userId: "user_789",
        name: "Dr. Wilson",
        role: "observer",        â† Joined via code
        joinedAt: "2024-11-08T10:10:00Z",
        leftAt: "2024-11-08T10:30:00Z"  â† Left session
      }
    ]
  }
```

## Key Features Illustrated

1. **Unique Identifiers**: Each session has 3 IDs (sessionId, uniqueLink, shareableCode)
2. **Multiple Join Methods**: Link, Code, or Browse public sessions
3. **Real-time Sync**: Socket.IO broadcasts all actions to participants
4. **Persistent Storage**: All metadata and interactions saved to MongoDB
5. **Participant Tracking**: Full history of who joined, when, and their role
6. **Status Management**: Track session state (idle â†’ active â†’ completed)

## System Benefits

âœ… **Easy Sharing**: Copy link or share 8-character code
âœ… **Real-time Collaboration**: See all participants' actions instantly
âœ… **Data Persistence**: All sessions saved for review/analytics
âœ… **Scalable**: Supports multiple concurrent sessions
âœ… **Secure**: Authentication required, invite-only option available
âœ… **User-friendly**: Simple UI for creating and joining sessions
